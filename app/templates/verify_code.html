{% extends "layout.html" %}
{% block body %}

<div class="row justify-content-center">
  <div class="col-md-6 col-lg-4">
    <div class="card shadow-lg rounded-4 animate__animated animate__fadeInUp">
      <div class="card-body p-4">
        <h3 class="text-center text-primary mb-3"><i class="bi bi-shield-lock"></i> Verify Code</h3>
        <p class="text-muted text-center mb-4">
          Enter the 6-digit code sent to your email.
        </p>

        <form method="POST" id="verify-form">
          <div class="d-flex justify-content-between mb-3">
            {% for i in range(6) %}
            <input
              type="text"
              name="code{{ i }}"
              maxlength="1"
              class="form-control text-center code-box"
              required
            >
            {% endfor %}
          </div>

          <button type="submit" class="btn btn-success w-100 btn-hover-scale">
            Verify Code
          </button>
        </form>

        <div class="text-center mt-3">
          <small class="text-muted">Didn't receive the code? <a href="{{ url_for('forgot_password') }}" class="text-decoration-none text-primary">Resend</a></small>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
  .code-box {
    width: 50px;
    height: 50px;
    font-size: 1.5rem;
    border: 2px solid #ced4da;
    border-radius: 8px;
    transition: border-color 0.3s, box-shadow 0.3s;
  }

  .code-box:focus {
    border-color: #198754;
    box-shadow: 0 0 8px rgba(25, 135, 84, 0.3);
    outline: none;
  }

  .btn-hover-scale {
    transition: transform 0.2s, box-shadow 0.2s;
  }
  .btn-hover-scale:hover {
    transform: scale(1.05);
    box-shadow: 0 5px 15px rgba(0,0,0,0.15);
  }
</style>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

<script>
  // Auto-focus next input after typing
  const inputs = document.querySelectorAll('.code-box');
  inputs.forEach((input, idx) => {
    input.addEventListener('input', () => {
      if (input.value.length === 1 && idx < inputs.length - 1) {
        inputs[idx + 1].focus();
      }
    });

    input.addEventListener('keydown', (e) => {
      if (e.key === 'Backspace' && !input.value && idx > 0) {
        inputs[idx - 1].focus();
      }
    });
  });

  // Combine all digits into one hidden input before submit
  document.getElementById('verify-form').addEventListener('submit', function(e) {
    const code = Array.from(inputs).map(i => i.value).join('');
    const hiddenInput = document.createElement('input');
    hiddenInput.type = 'hidden';
    hiddenInput.name = 'code';
    hiddenInput.value = code;
    this.appendChild(hiddenInput);
  });
</script>

{% endblock %}
